{% extends 'base_admin.html.twig' %}

{% block title %}üè¢ Admin Dashboard - Lawanan Real Estate{% endblock %}

{% block body %}
<style>
    /* --- HERO SECTION --- */
    .admin-hero {
        background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)),
                    url('https://images.unsplash.com/photo-1599423300746-b62533397364?auto=format&fit=crop&w=1400&q=80') center/cover no-repeat;
        color: white;
        padding: 100px 20px;
        text-align: center;
    }

    /* --- TABLE STYLE --- */
    #adminTable {
        background: #fff !important;
        border-collapse: collapse !important;
        border-radius: 10px;
        overflow: hidden;
    }

    #adminTable thead th {
        background-color: #003366 !important;
        color: #fff !important;
        text-align: center;
        font-weight: 600;
        padding: 12px;
    }

    #adminTable tbody td {
        text-align: center;
        vertical-align: middle;
        padding: 10px;
        color: #222;
    }

    #adminTable tbody tr:hover {
        background-color: #f2f6ff !important;
        transition: background-color 0.3s ease;
    }

    /* --- DATATABLES CONTROL STYLING --- */
    .dataTables_wrapper {
        margin-top: 20px;
        font-size: 0.95rem;
    }

    /* Entries per page ("Show X entries") */
    .dataTables_length {
        display: flex;
        align-items: center;
        gap: 8px;
        background: #f8f9fa;
        padding: 10px 15px;
        border-radius: 10px;
        font-weight: 500;
        color: #003366;
    }

    .dataTables_length select {
        border: 1px solid #ccc;
        border-radius: 6px;
        padding: 5px 8px;
        color: #003366;
        background: white;
        cursor: pointer;
        transition: border 0.3s ease;
    }

    .dataTables_length select:hover {
        border-color: #0d6efd;
    }

    /* Search box ("üîç Search") */
    .dataTables_filter {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 6px;
        background: #f8f9fa;
        padding: 10px 15px;
        border-radius: 10px;
        font-weight: 500;
        color: #003366;
    }

    .dataTables_filter input {
        border: 1px solid #ccc;
        border-radius: 25px;
        padding: 6px 14px;
        outline: none;
        transition: 0.3s;
    }

    .dataTables_filter input:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 5px rgba(13, 110, 253, 0.3);
    }

    /* Info text ("Showing 1 to 3 of 3 properties") */
    .dataTables_info {
        margin-top: 12px;
        background: #f8f9fa;
        padding: 10px 15px;
        border-radius: 10px;
        color: #003366;
        font-weight: 500;
    }

    /* Pagination */
    .dataTables_paginate {
        margin-top: 12px;
    }

    .dataTables_wrapper .dataTables_paginate .paginate_button {
        border-radius: 8px !important;
        padding: 6px 12px !important;
        margin: 0 3px !important;
        background-color: #e9ecef !important;
        color: #003366 !important;
        border: none !important;
        transition: background-color 0.3s ease;
    }

    .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
        background-color: #003366 !important;
        color: #fff !important;
    }

    .dataTables_wrapper .dataTables_paginate .paginate_button.current {
        background-color: #0d6efd !important;
        color: #fff !important;
    }
</style>

<!-- HERO -->
<section class="admin-hero">
    <h1>üè¢ ADMIN DASHBOARD</h1>
    <p>Manage all listed properties efficiently.</p>
</section>

<div class="container mt-5">
    {% for message in app.flashes('success') %}
        <div class="alert alert-success text-center" id="flash-message">{{ message }}</div>
    {% endfor %}

    <h2 class="text-center mb-4 text-primary">üìã Property Management</h2>

    <div class="text-end mb-3">
        <a href="{{ path('app_property_new') }}" class="btn btn-success">‚ûï Add New Property</a>
    </div>

    <table id="adminTable" class="table table-bordered table-striped admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Description</th>
                <th>Price</th>
                <th>Location</th>
                <th>Bedrooms</th>
                <th>Category</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for property in properties %}
            <tr>
                <td>{{ property.id }}</td>
                <td>{{ property.title }}</td>
                <td>{{ property.description|slice(0, 30) ~ '...' }}</td>
                <td>‚Ç±{{ property.price|number_format(2) }}</td>
                <td>{{ property.location }}</td>
                <td>{{ property.bedrooms }}</td>
                <td>
                    {% if property.category %}
                        <span class="badge bg-primary">{{ property.category.name }}</span>
                    {% else %}
                        <span class="text-muted">No Category</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ path('app_property_edit', {'id': property.id}) }}" class="btn btn-warning btn-sm">‚úèÔ∏è Edit</a>
                    <a href="{{ path('app_admin_property_delete', {'id': property.id}) }}"
                       class="btn btn-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this property?')">üóëÔ∏è Delete</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="8" class="text-center text-muted">No properties found.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<!-- AUTO-HIDE FLASH MESSAGE -->
<script>
    setTimeout(() => {
        const msg = document.getElementById('flash-message');
        if (msg) msg.style.display = 'none';
    }, 3000);
</script>

<!-- DATATABLE INIT -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        new DataTable('#adminTable', {
            responsive: true,
            pageLength: 5,
            lengthMenu: [5, 10, 25, 50],
            language: {
                search: "üîç Search:",
                lengthMenu: "Show _MENU_ entries per page",
                info: "Showing _START_ to _END_ of _TOTAL_ properties",
                infoEmpty: "No properties available",
                zeroRecords: "No matching records found",
                paginate: {
                    previous: "‚¨ÖÔ∏è",
                    next: "‚û°Ô∏è"
                }
            }
        });
    });
</script>

{% endblock %}
